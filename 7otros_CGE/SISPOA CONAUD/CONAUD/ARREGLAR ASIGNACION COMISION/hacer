bd_cge_poa_conaud_local_b
postgres
=lista aprobar
backup_20240723_203517.sql
=lista consoli
backup_20240723_212252.sql

3403668 fgerente
4813387 f
4385501 a
4755293 s
3403668 com

4813387 = ROL_GESTION_INSTITUCIONAL_APROBADOR
4385501 = ROL_GESTION_INSTITUCIONAL_VERIFICADOR
570.0013.4


EVALUACION
http://172.16.75.100:7002/sispoa/parametricas/hitos-rutas-criticas?ttr_codigo=(9)&hrc_estado=(1)

AUDITORIA
http://172.16.75.100:7002/sispoa/parametricas/hitos-rutas-criticas?ttr_codigo=(12)&hrc_estado=(1)

/home/yhamil/Documents/conaud-frontend/src/components/informes-uai/component/tables/informes-uai.table.jsx

AsignacionesHorasUsadasPlanificadorCalendar


http://172.16.75.100:3002/conaud/inicio-evaluacion-informe?act_codigo=1537&iua_codigo=841


ðŸ±==ii1==> ~ customConfig: {
  method: 'POST',
  baseUrl: 'http://localhost:7091',
  url: '/area-unidad-responsables',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJwZXJfY29kaWdvIjoxMDE2LCJzaXN0ZW1hcyI6W3sic2lzY2dlX2NvZGlnbyI6MTAsInNpc2NnZV9zaWdsYSI6InNpc2F1ZCJ9LHsic2lzY2dlX2NvZGlnbyI6MzIsInNpc2NnZV9zaWdsYSI6ImNvcnJlc3BvbmRlbmNpYV9pbnRlcm5hIn0seyJzaXNjZ2VfY29kaWdvIjozNCwic2lzY2dlX3NpZ2xhIjoic2lzcG9hIn0seyJzaXNjZ2VfY29kaWdvIjozNSwic2lzY2dlX3NpZ2xhIjoiZmlfY29uYXVkIn0seyJzaXNjZ2VfY29kaWdvIjozNywic2lzY2dlX3NpZ2xhIjoiY29uYXVkIn1dLCJyb2xlcyI6W3sic2lzY2dlX2NvZGlnbyI6MTAsInJvbF9jb2RpZ28iOjM2LCJyb2xfZGVzY3JpcGNpb24iOiJHRVJFTlRFIERFUEFSVEFNRU5UQUwifSx7InNpc2NnZV9jb2RpZ28iOjMyLCJyb2xfY29kaWdvIjoxNzQsInJvbF9kZXNjcmlwY2lvbiI6IkVOQ0FSR0FETyBVTklEQUQgT1JHQU5JWkFDSU9OQUwifSx7InNpc2NnZV9jb2RpZ28iOjM0LCJyb2xfY29kaWdvIjoxOTAsInJvbF9kZXNjcmlwY2lvbiI6Ik9wZXJhZG9yIEZvcm11bGFyaW8ifSx7InNpc2NnZV9jb2RpZ28iOjM1LCJyb2xfY29kaWdvIjoxODcsInJvbF9kZXNjcmlwY2lvbiI6IkFQUk9CQURPUiJ9LHsic2lzY2dlX2NvZGlnbyI6MzcsInJvbF9jb2RpZ28iOjIwOCwicm9sX2Rlc2NyaXBjaW9uIjoiT3BlcmFkb3IgRm9ybXVsYXJpbyJ9LHsic2lzY2dlX2NvZGlnbyI6MzQsInJvbF9jb2RpZ28iOjE5OCwicm9sX2Rlc2NyaXBjaW9uIjoiVmVyaWZpY2Fkb3IgRm9ybXVsYXJpbyJ9XSwiaWQiOiI0NDVmNTgzOS1hMWY4LTQ5ZTEtODE1Ni0zY2RmNDY5ODAxYjUiLCJ0aXBvIjoidXN1YXJpbyIsImlhdCI6MTcyMTc4NDI2MCwiZXhwIjoxNzIxODEzMDYwLCJtb21lbnQiOiIyMDI0LTA3LTIzVDIxOjI0OjIwLTA0OjAwIn0.bLY-VQpjArEQ7J0uegQ6xhvjaZW4xZeR0msxgRb3_CpO3yHbKkEnde5YALlqQ74kRJ1H5ltU2gi6Sk3xtpGmQg',
    'Content-Type': 'application/json'
  },
  body: CreateAreaUnidadResponsablesDto {
    poa_codigo: 2,
    aun_codigo_ejecutora: 59,
    aun_codigo_rol: 59,
    rol_codigo: 5,
    per_codigo: 1016,
    cro_codigo: 3,
    s_token: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJwZXJfY29kaWdvIjoxMDE2LCJzaXN0ZW1hcyI6W3sic2lzY2dlX2NvZGlnbyI6MTAsInNpc2NnZV9zaWdsYSI6InNpc2F1ZCJ9LHsic2lzY2dlX2NvZGlnbyI6MzIsInNpc2NnZV9zaWdsYSI6ImNvcnJlc3BvbmRlbmNpYV9pbnRlcm5hIn0seyJzaXNjZ2VfY29kaWdvIjozNCwic2lzY2dlX3NpZ2xhIjoic2lzcG9hIn0seyJzaXNjZ2VfY29kaWdvIjozNSwic2lzY2dlX3NpZ2xhIjoiZmlfY29uYXVkIn0seyJzaXNjZ2VfY29kaWdvIjozNywic2lzY2dlX3NpZ2xhIjoiY29uYXVkIn1dLCJyb2xlcyI6W3sic2lzY2dlX2NvZGlnbyI6MTAsInJvbF9jb2RpZ28iOjM2LCJyb2xfZGVzY3JpcGNpb24iOiJHRVJFTlRFIERFUEFSVEFNRU5UQUwifSx7InNpc2NnZV9jb2RpZ28iOjMyLCJyb2xfY29kaWdvIjoxNzQsInJvbF9kZXNjcmlwY2lvbiI6IkVOQ0FSR0FETyBVTklEQUQgT1JHQU5JWkFDSU9OQUwifSx7InNpc2NnZV9jb2RpZ28iOjM0LCJyb2xfY29kaWdvIjoxOTAsInJvbF9kZXNjcmlwY2lvbiI6Ik9wZXJhZG9yIEZvcm11bGFyaW8ifSx7InNpc2NnZV9jb2RpZ28iOjM1LCJyb2xfY29kaWdvIjoxODcsInJvbF9kZXNjcmlwY2lvbiI6IkFQUk9CQURPUiJ9LHsic2lzY2dlX2NvZGlnbyI6MzcsInJvbF9jb2RpZ28iOjIwOCwicm9sX2Rlc2NyaXBjaW9uIjoiT3BlcmFkb3IgRm9ybXVsYXJpbyJ9LHsic2lzY2dlX2NvZGlnbyI6MzQsInJvbF9jb2RpZ28iOjE5OCwicm9sX2Rlc2NyaXBjaW9uIjoiVmVyaWZpY2Fkb3IgRm9ybXVsYXJpbyJ9XSwiaWQiOiI0NDVmNTgzOS1hMWY4LTQ5ZTEtODE1Ni0zY2RmNDY5ODAxYjUiLCJ0aXBvIjoidXN1YXJpbyIsImlhdCI6MTcyMTc4NDI2MCwiZXhwIjoxNzIxODEzMDYwLCJtb21lbnQiOiIyMDI0LTA3LTIzVDIxOjI0OjIwLTA0OjAwIn0.bLY-VQpjArEQ7J0uegQ6xhvjaZW4xZeR0msxgRb3_CpO3yHbKkEnde5YALlqQ74kRJ1H5ltU2gi6Sk3xtpGmQg'
  },
  json: true,
  timeout: 10000,
  proxy: false
}


llega:
  CreateAreaUnidadResponsablesDto {
    poa_codigo: 2,
    aun_codigo_ejecutora: 59,
    aun_codigo_rol: 59,
    rol_codigo: 5,
    per_codigo: 1016,
    cro_codigo: 3,
    s_token: 
      'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJwZXJfY29kaWdvIjoxMDE2LCJzaXN0ZW1hcyI6W3sic2lzY2dlX2NvZGlnbyI6MTAsInNpc2NnZV9zaWdsYSI6InNpc2F1ZCJ9LHsic2lzY2dlX2NvZGlnbyI6MzIsInNpc2NnZV9zaWdsYSI6ImNvcnJlc3BvbmRlbmNpYV9pbnRlcm5hIn0seyJzaXNjZ2VfY29kaWdvIjozNCwic2lzY2dlX3NpZ2xhIjoic2lzcG9hIn0seyJzaXNjZ2VfY29kaWdvIjozNSwic2lzY2dlX3NpZ2xhIjoiZmlfY29uYXVkIn0seyJzaXNjZ2VfY29kaWdvIjozNywic2lzY2dlX3NpZ2xhIjoiY29uYXVkIn1dLCJyb2xlcyI6W3sic2lzY2dlX2NvZGlnbyI6MTAsInJvbF9jb2RpZ28iOjM2LCJyb2xfZGVzY3JpcGNpb24iOiJHRVJFTlRFIERFUEFSVEFNRU5UQUwifSx7InNpc2NnZV9jb2RpZ28iOjMyLCJyb2xfY29kaWdvIjoxNzQsInJvbF9kZXNjcmlwY2lvbiI6IkVOQ0FSR0FETyBVTklEQUQgT1JHQU5JWkFDSU9OQUwifSx7InNpc2NnZV9jb2RpZ28iOjM0LCJyb2xfY29kaWdvIjoxOTAsInJvbF9kZXNjcmlwY2lvbiI6Ik9wZXJhZG9yIEZvcm11bGFyaW8ifSx7InNpc2NnZV9jb2RpZ28iOjM1LCJyb2xfY29kaWdvIjoxODcsInJvbF9kZXNjcmlwY2lvbiI6IkFQUk9CQURPUiJ9LHsic2lzY2dlX2NvZGlnbyI6MzcsInJvbF9jb2RpZ28iOjIwOCwicm9sX2Rlc2NyaXBjaW9uIjoiT3BlcmFkb3IgRm9ybXVsYXJpbyJ9LHsic2lzY2dlX2NvZGlnbyI6MzQsInJvbF9jb2RpZ28iOjE5OCwicm9sX2Rlc2NyaXBjaW9uIjoiVmVyaWZpY2Fkb3IgRm9ybXVsYXJpbyJ9XSwiaWQiOiI3ZGRjNDI1Zi05ZTliLTQ1NTItYjA3Ny03NzA3YTJkYzU4MjkiLCJ0aXBvIjoidXN1YXJpbyIsImlhdCI6MTcyMTgyNzA1MiwiZXhwIjoxNzIxODU1ODUyLCJtb21lbnQiOiIyMDI0LTA3LTI0VDA5OjE3OjMyLTA0OjAwIn0.lGd5wA0ac06TBnTMGwiMmIo3_UcxxBscRncagwIMVWzY4cqCUYuVlWoTrovTeyeSr_eHkL_rc3MkTuwVUN7RRA',
    usuario: 1016
  }


#####CAMBIAR ESTO POR LO DE MAS ABAJO
  @LoggerMethod
  private async findAreaUnidadAndPoaCodigoWithActCodigo(act_codigo: number, manager: EntityManager) {
    try {
      let AreaUnidad = `
        SELECT
              oau.oau_codigo,
              oau.pobj_codigo,
              oau.aun_codigo_ejecutora,
              oau.aun_codigo_supervisora
        FROM  estructura_poa.objetivos_area_unidad oau
        WHERE oau.pobj_codigo IN (SELECT a.pobj_codigo FROM estructura_poa.actividades a WHERE a.act_codigo = ${act_codigo})
        ;
      `;
      const resultAreaUnidad = await manager.query(AreaUnidad);

      let PoaCodigo = `
        SELECT
              p.poa_codigo
        FROM	estructura_poa.poas p
        WHERE	p.poa_codigo IN (
                SELECT	po.poa_codigo
                FROM	estructura_poa.poas_objetivos po
                WHERE	po.pobj_codigo IN (SELECT a.pobj_codigo FROM estructura_poa.actividades a WHERE a.act_codigo = ${act_codigo})
              )
      `;
      const resultPoaCodigo = await manager.query(PoaCodigo);

      let result: any = {
        ...resultAreaUnidad[0],
        ...resultPoaCodigo[0]
      };

      return CustomService.verifyingDataResult(result, this.message_custom);
    } catch (error) {
      this.logger.debug(error);
      throwError(400, error.message);
    }
  }
  
#####ESTO DEBE ESTAR######
  @LoggerMethod
  private async findAreaUnidadAndPoaCodigoWithActCodigoV2(act_codigo: number, manager: EntityManager) {
    try {
      let sql = `
        SELECT
              a.act_codigo,
              a.aun_codigo_ejecutora,
              a.aun_codigo_supervisora, 
              po.poa_codigo
        FROM  estructura_poa.actividades a
              LEFT JOIN estructura_poa.poas_objetivos po ON a.pobj_codigo = po.pobj_codigo
        WHERE TRUE
              AND a.act_codigo IN (${act_codigo})
        ;
      `;
      const result = await manager.query(sql);
      return CustomService.verifyingDataResult(result, this.message_custom);
    } catch (error) {
      this.logger.debug(error);
      throwError(400, error.message);
    }
  }
